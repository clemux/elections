<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Presidentielles premier tour</title>
    <link rel="stylesheet" href="static/main.css">
</head>
<body>
<label for="deptPicker">Departement</label>
<input type="text" id="deptPicker" value="67">
<label for="circPicker">Circonscription</label>
<input type="text" id="circPicker" value="01">
<input type="button" value="Afficher" id="showButton">
<table id="results"></table>
</body>
</html>
<script>
    function updateTable(data) {
        const candidates = Object.entries(data['candidates'])
        table = document.getElementById('results')
        table.innerHTML = ''
        candidates.forEach(([candidate, percentage]) => {
            newRow = table.insertRow()
            nameCell = newRow.insertCell()
            nameCell.appendChild(document.createTextNode(candidate))

            percentageCell = newRow.insertCell()
            percentageCell.appendChild(document.createTextNode(percentage))
        })
    }

    button = document.getElementById('showButton')
    deptField = document.getElementById('deptPicker')
    circField = document.getElementById('circPicker')
    button.addEventListener('click', function () {
        apiData = fetch('/results?code_dept=' + deptField.value + '&code_circ=' + circField.value)
            .then(response => response.json())
            .then(data => updateTable(data))
    })
</script>